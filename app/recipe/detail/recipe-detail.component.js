"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var core_1 = require("@angular/core");
var core_2 = require("../../core");
var data_1 = require("../../data");
var RecipeDetailComponent = (function () {
    function RecipeDetailComponent(core, DA, DL) {
        this.core = core;
        this.DA = DA;
        this.DL = DL;
        this.isEditing = false;
        if (this.DL.Recipe == null) {
            this.DL.Recipe = new data_1.RecipeInfo(DL.NO_IMAGE_URL);
        }
        if (!this.DL.Recipe.ImageURL)
            this.DL.Recipe.ImageURL = DL.NO_IMAGE_URL;
        this.imageURL = this.DL.Recipe.ImageURL;
    }
    RecipeDetailComponent.prototype.StartEdit = function (args) {
        this.editingTextView = args.object;
        this.isEditing = true;
    };
    RecipeDetailComponent.prototype.StopEdit = function () {
        this.isEditing = false;
        this.editingTextView.dismissSoftInput();
    };
    RecipeDetailComponent.prototype.SelectImage = function () {
        this.DL.SelectImage(this.DL.Recipe.Name);
    };
    RecipeDetailComponent.prototype.LoadComponent = function (selector) {
        this.core.LoadComponent(selector);
    };
    RecipeDetailComponent.prototype.Save = function () {
        this.DA.RecipeSave();
        this.loadList();
    };
    RecipeDetailComponent.prototype.Cancel = function () {
        this.loadList();
    };
    RecipeDetailComponent.prototype.loadList = function () {
        this.DL.LoadComponent("recipe-list");
    };
    RecipeDetailComponent.prototype.ngOnInit = function () {
        var _this = this;
        this.DL.TITLE = "Recipe Details";
        this.DA.ImageUploaded.subscribe(function (url) {
            if (_this.DL.TITLE == "Recipe Details") {
                _this.imageURL = url;
                _this.DL.Recipe.ImageURL = url;
                _this.DL.IsUploading = false;
            }
        });
        this.DL.ImageSelected.subscribe(function (source) {
            if (_this.DL.TITLE == "Recipe Details") {
                _this.DL.IsUploading = true;
                _this.DA.UploadImage(source, 'images/recipes/' + _this.DL.Recipe.Name + '.png');
            }
        });
    };
    RecipeDetailComponent = __decorate([
        core_1.Component({
            moduleId: module.id,
            selector: 'recipe-detail',
            templateUrl: './recipe-detail.component.html',
            styleUrls: ['./recipe-detail.component.scss']
        }),
        __metadata("design:paramtypes", [core_2.Core, data_1.DataAccess, data_1.DataLayer])
    ], RecipeDetailComponent);
    return RecipeDetailComponent;
}());
exports.RecipeDetailComponent = RecipeDetailComponent;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicmVjaXBlLWRldGFpbC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJyZWNpcGUtZGV0YWlsLmNvbXBvbmVudC50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLHNDQUFrRDtBQUVsRCxtQ0FBa0M7QUFDbEMsbUNBQStEO0FBUS9EO0lBS0UsK0JBQW1CLElBQVUsRUFBVSxFQUFjLEVBQVUsRUFBYTtRQUF6RCxTQUFJLEdBQUosSUFBSSxDQUFNO1FBQVUsT0FBRSxHQUFGLEVBQUUsQ0FBWTtRQUFVLE9BQUUsR0FBRixFQUFFLENBQVc7UUFINUUsY0FBUyxHQUFZLEtBQUssQ0FBQztRQUl6QixFQUFFLENBQUEsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLE1BQU0sSUFBSSxJQUFJLENBQUMsQ0FBQyxDQUFDO1lBQzFCLElBQUksQ0FBQyxFQUFFLENBQUMsTUFBTSxHQUFHLElBQUksaUJBQVUsQ0FBQyxFQUFFLENBQUMsWUFBWSxDQUFDLENBQUM7UUFDbkQsQ0FBQztRQUVELEVBQUUsQ0FBQSxDQUFDLENBQUMsSUFBSSxDQUFDLEVBQUUsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDO1lBQzFCLElBQUksQ0FBQyxFQUFFLENBQUMsTUFBTSxDQUFDLFFBQVEsR0FBRyxFQUFFLENBQUMsWUFBWSxDQUFDO1FBRTVDLElBQUksQ0FBQyxRQUFRLEdBQUcsSUFBSSxDQUFDLEVBQUUsQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDO0lBQzFDLENBQUM7SUFFTSx5Q0FBUyxHQUFoQixVQUFpQixJQUFJO1FBQ25CLElBQUksQ0FBQyxlQUFlLEdBQWEsSUFBSSxDQUFDLE1BQU0sQ0FBQztRQUM3QyxJQUFJLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQztJQUN4QixDQUFDO0lBRU0sd0NBQVEsR0FBZjtRQUNFLElBQUksQ0FBQyxTQUFTLEdBQUcsS0FBSyxDQUFDO1FBQ3ZCLElBQUksQ0FBQyxlQUFlLENBQUMsZ0JBQWdCLEVBQUUsQ0FBQztJQUMxQyxDQUFDO0lBRU0sMkNBQVcsR0FBbEI7UUFDRSxJQUFJLENBQUMsRUFBRSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUMzQyxDQUFDO0lBRU0sNkNBQWEsR0FBcEIsVUFBcUIsUUFBZ0I7UUFDbkMsSUFBSSxDQUFDLElBQUksQ0FBQyxhQUFhLENBQUMsUUFBUSxDQUFDLENBQUM7SUFDcEMsQ0FBQztJQUVNLG9DQUFJLEdBQVg7UUFDRSxJQUFJLENBQUMsRUFBRSxDQUFDLFVBQVUsRUFBRSxDQUFDO1FBQ3JCLElBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQztJQUNsQixDQUFDO0lBRU0sc0NBQU0sR0FBYjtRQUNFLElBQUksQ0FBQyxRQUFRLEVBQUUsQ0FBQztJQUNsQixDQUFDO0lBRU8sd0NBQVEsR0FBaEI7UUFDRSxJQUFJLENBQUMsRUFBRSxDQUFDLGFBQWEsQ0FBQyxhQUFhLENBQUMsQ0FBQztJQUN2QyxDQUFDO0lBRUQsd0NBQVEsR0FBUjtRQUFBLGlCQWdCQztRQWZDLElBQUksQ0FBQyxFQUFFLENBQUMsS0FBSyxHQUFHLGdCQUFnQixDQUFDO1FBQ2pDLElBQUksQ0FBQyxFQUFFLENBQUMsYUFBYSxDQUFDLFNBQVMsQ0FBQyxVQUFBLEdBQUc7WUFDakMsRUFBRSxDQUFBLENBQUMsS0FBSSxDQUFDLEVBQUUsQ0FBQyxLQUFLLElBQUksZ0JBQWdCLENBQUMsQ0FBQyxDQUFDO2dCQUNyQyxLQUFJLENBQUMsUUFBUSxHQUFHLEdBQUcsQ0FBQztnQkFDcEIsS0FBSSxDQUFDLEVBQUUsQ0FBQyxNQUFNLENBQUMsUUFBUSxHQUFHLEdBQUcsQ0FBQztnQkFDOUIsS0FBSSxDQUFDLEVBQUUsQ0FBQyxXQUFXLEdBQUcsS0FBSyxDQUFDO1lBQzlCLENBQUM7UUFDSCxDQUFDLENBQUMsQ0FBQztRQUVILElBQUksQ0FBQyxFQUFFLENBQUMsYUFBYSxDQUFDLFNBQVMsQ0FBQyxVQUFBLE1BQU07WUFDcEMsRUFBRSxDQUFBLENBQUMsS0FBSSxDQUFDLEVBQUUsQ0FBQyxLQUFLLElBQUksZ0JBQWdCLENBQUMsQ0FBQyxDQUFDO2dCQUNyQyxLQUFJLENBQUMsRUFBRSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUM7Z0JBQzNCLEtBQUksQ0FBQyxFQUFFLENBQUMsV0FBVyxDQUFDLE1BQU0sRUFBRSxpQkFBaUIsR0FBRyxLQUFJLENBQUMsRUFBRSxDQUFDLE1BQU0sQ0FBQyxJQUFJLEdBQUcsTUFBTSxDQUFDLENBQUM7WUFDaEYsQ0FBQztRQUNILENBQUMsQ0FBQyxDQUFBO0lBQ0osQ0FBQztJQS9EVSxxQkFBcUI7UUFOakMsZ0JBQVMsQ0FBQztZQUNULFFBQVEsRUFBRSxNQUFNLENBQUMsRUFBRTtZQUNuQixRQUFRLEVBQUUsZUFBZTtZQUN6QixXQUFXLEVBQUUsZ0NBQWdDO1lBQzdDLFNBQVMsRUFBRSxDQUFDLGdDQUFnQyxDQUFDO1NBQzlDLENBQUM7eUNBTXlCLFdBQUksRUFBYyxpQkFBVSxFQUFjLGdCQUFTO09BTGpFLHFCQUFxQixDQWdFakM7SUFBRCw0QkFBQztDQUFBLEFBaEVELElBZ0VDO0FBaEVZLHNEQUFxQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IENvbXBvbmVudCwgT25Jbml0IH0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBUZXh0VmlldyB9IGZyb20gXCJ1aS90ZXh0LXZpZXdcIjtcbmltcG9ydCB7IENvcmUgfSBmcm9tIFwiLi4vLi4vY29yZVwiO1xuaW1wb3J0IHsgRGF0YUxheWVyLCBEYXRhQWNjZXNzLCBSZWNpcGVJbmZvIH0gZnJvbSBcIi4uLy4uL2RhdGFcIjtcblxuQENvbXBvbmVudCh7XG4gIG1vZHVsZUlkOiBtb2R1bGUuaWQsXG4gIHNlbGVjdG9yOiAncmVjaXBlLWRldGFpbCcsXG4gIHRlbXBsYXRlVXJsOiAnLi9yZWNpcGUtZGV0YWlsLmNvbXBvbmVudC5odG1sJyxcbiAgc3R5bGVVcmxzOiBbJy4vcmVjaXBlLWRldGFpbC5jb21wb25lbnQuc2NzcyddXG59KVxuZXhwb3J0IGNsYXNzIFJlY2lwZURldGFpbENvbXBvbmVudCBpbXBsZW1lbnRzIE9uSW5pdCB7XG4gIGltYWdlVVJMOiBzdHJpbmc7XG4gIGlzRWRpdGluZzogYm9vbGVhbiA9IGZhbHNlO1xuICBlZGl0aW5nVGV4dFZpZXc6IFRleHRWaWV3O1xuXG4gIGNvbnN0cnVjdG9yKHB1YmxpYyBjb3JlOiBDb3JlLCBwcml2YXRlIERBOiBEYXRhQWNjZXNzLCBwcml2YXRlIERMOiBEYXRhTGF5ZXIpIHtcbiAgICBpZih0aGlzLkRMLlJlY2lwZSA9PSBudWxsKSB7XG4gICAgICB0aGlzLkRMLlJlY2lwZSA9IG5ldyBSZWNpcGVJbmZvKERMLk5PX0lNQUdFX1VSTCk7XG4gICAgfVxuXG4gICAgaWYoIXRoaXMuREwuUmVjaXBlLkltYWdlVVJMKVxuICAgICAgdGhpcy5ETC5SZWNpcGUuSW1hZ2VVUkwgPSBETC5OT19JTUFHRV9VUkw7XG5cbiAgICB0aGlzLmltYWdlVVJMID0gdGhpcy5ETC5SZWNpcGUuSW1hZ2VVUkw7XG4gIH1cblxuICBwdWJsaWMgU3RhcnRFZGl0KGFyZ3MpIHtcbiAgICB0aGlzLmVkaXRpbmdUZXh0VmlldyA9IDxUZXh0Vmlldz5hcmdzLm9iamVjdDtcbiAgICB0aGlzLmlzRWRpdGluZyA9IHRydWU7XG4gIH1cblxuICBwdWJsaWMgU3RvcEVkaXQoKSB7XG4gICAgdGhpcy5pc0VkaXRpbmcgPSBmYWxzZTtcbiAgICB0aGlzLmVkaXRpbmdUZXh0Vmlldy5kaXNtaXNzU29mdElucHV0KCk7XG4gIH1cblxuICBwdWJsaWMgU2VsZWN0SW1hZ2UoKSB7XG4gICAgdGhpcy5ETC5TZWxlY3RJbWFnZSh0aGlzLkRMLlJlY2lwZS5OYW1lKTtcbiAgfVxuXG4gIHB1YmxpYyBMb2FkQ29tcG9uZW50KHNlbGVjdG9yOiBzdHJpbmcpIHtcbiAgICB0aGlzLmNvcmUuTG9hZENvbXBvbmVudChzZWxlY3Rvcik7XG4gIH1cblxuICBwdWJsaWMgU2F2ZSgpIHtcbiAgICB0aGlzLkRBLlJlY2lwZVNhdmUoKTtcbiAgICB0aGlzLmxvYWRMaXN0KCk7XG4gIH1cblxuICBwdWJsaWMgQ2FuY2VsKCkge1xuICAgIHRoaXMubG9hZExpc3QoKTtcbiAgfVxuXG4gIHByaXZhdGUgbG9hZExpc3QoKSB7XG4gICAgdGhpcy5ETC5Mb2FkQ29tcG9uZW50KFwicmVjaXBlLWxpc3RcIik7XG4gIH1cbiAgXG4gIG5nT25Jbml0KCkgeyBcbiAgICB0aGlzLkRMLlRJVExFID0gXCJSZWNpcGUgRGV0YWlsc1wiO1xuICAgIHRoaXMuREEuSW1hZ2VVcGxvYWRlZC5zdWJzY3JpYmUodXJsID0+IHtcbiAgICAgIGlmKHRoaXMuREwuVElUTEUgPT0gXCJSZWNpcGUgRGV0YWlsc1wiKSB7XG4gICAgICAgIHRoaXMuaW1hZ2VVUkwgPSB1cmw7XG4gICAgICAgIHRoaXMuREwuUmVjaXBlLkltYWdlVVJMID0gdXJsO1xuICAgICAgICB0aGlzLkRMLklzVXBsb2FkaW5nID0gZmFsc2U7XG4gICAgICB9XG4gICAgfSk7XG5cbiAgICB0aGlzLkRMLkltYWdlU2VsZWN0ZWQuc3Vic2NyaWJlKHNvdXJjZSA9PiB7XG4gICAgICBpZih0aGlzLkRMLlRJVExFID09IFwiUmVjaXBlIERldGFpbHNcIikge1xuICAgICAgICB0aGlzLkRMLklzVXBsb2FkaW5nID0gdHJ1ZTtcbiAgICAgICAgdGhpcy5EQS5VcGxvYWRJbWFnZShzb3VyY2UsICdpbWFnZXMvcmVjaXBlcy8nICsgdGhpcy5ETC5SZWNpcGUuTmFtZSArICcucG5nJyk7XG4gICAgICB9XG4gICAgfSlcbiAgfVxufVxuIl19